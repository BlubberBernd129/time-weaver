# TimeTracker Docker Compose Configuration
# Self-Hosted Zeit-Tracking Anwendung
#
# ============================================================================
# UI OVERHAUL v3.1 - Pausen-Anzeige, Kalender-Scroll, Mitternacht-Stopp
# ============================================================================
#
# ÄNDERUNGEN v3.1:
#   ✅ Pausen werden in abgeschlossenen Einträgen angezeigt (Dashboard + Kalender)
#   ✅ Kalender: 24h-Ansicht (0-24 Uhr) mit Auto-Scroll zu 7 Uhr
#   ✅ Kalender: Pausen sind sichtbar + im Bearbeiten-Dialog editierbar
#   ✅ Mitternacht: Timer wird um 23:59:45 gestoppt (KEIN Split mehr)
#   ✅ Browser-Tab blinkt bei Auto-Stopp (visuelles Feedback)
#   ✅ Auto-Refresh: Wochenziele + QuickStats alle 5 Minuten aktualisiert
#   ✅ KW-Vergleich: Unterschiedliche Farben (Blau + Grün statt Kategorie-Farben)
#
# FEATURES v3.0:
#   - Reine Wochenbetrachtung (Statistik)
#   - 8-Wochen-Benchmark mit historischem Durchschnitt
#   - Manueller KW-Vergleich
#   - Stacked Bar Charts + Area Charts
#   - Live-Timeline mit Pausen-Editing
#   - Progress Rings für Wochenziele
#   - Glassmorphism-Design
#
# ============================================================================
# SYNC-FIX v2.1 - Multi-Device Timer Synchronisation
# ============================================================================
# Timer-Status wird NUR aus der Datenbank geladen (localStorage ignoriert)
#
# ============================================================================
# API-Routing (dynamisch basierend auf Browser-Hostname):
# - Lokal (192.168.178.43/localhost): http://192.168.178.43:8090
# - Strato-Relay (rtracker.nick-cloud.org): https://rapi.nick-cloud.org
# - Remote (Cloudflare): https://api.nick-cloud.org
#
# Verwendung:
# 1. Kopiere .env.example zu .env und passe die Werte an
# 2. docker compose up -d --build
# 3. Öffne http://localhost:3000 im Browser
#
# Für Updates:
# docker compose down && docker compose up -d --build

services:
  timetracker:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - VITE_SUPABASE_URL=${VITE_SUPABASE_URL:-}
        - VITE_SUPABASE_PUBLISHABLE_KEY=${VITE_SUPABASE_PUBLISHABLE_KEY:-}
        - VITE_SUPABASE_PROJECT_ID=${VITE_SUPABASE_PROJECT_ID:-}
    image: timetracker:latest
    container_name: timetracker
    ports:
      - "${PORT:-3000}:80"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s
    labels:
      - "com.timetracker.description=Zeit-Tracking Anwendung"
      - "com.timetracker.version=3.1.0"

networks:
  default:
    name: timetracker-network
