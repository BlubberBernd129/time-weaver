# TimeTracker Docker Compose Configuration
# Self-Hosted Zeit-Tracking Anwendung
#
# ============================================================================
# UI OVERHAUL v3.6 - Performance-Optimierungen
# ============================================================================
#
# ÄNDERUNGEN v3.6:
#   ✅ Performance: QuickStats mit useMemo optimiert (weniger Re-Renders)
#   ✅ Performance: Intervall nur bei laufendem Timer aktiv (1 Min statt immer)
#   ✅ Performance: DayTimeline Update von 1s auf 10s reduziert
#   ✅ Performance: Stabile Keys statt refreshKey für React-Komponenten
#   ✅ Live-Updates: Zeiten aktualisieren sich während Timer läuft
#
# ÄNDERUNGEN v3.5:
#   ✅ Auto-Pausen: Gillig + Keller Pausen (09:30-09:45, 15:00-15:15) werden
#      direkt beim Stoppen eingefügt, wenn der Eintrag die Zeit umfasst
#   ✅ Fix: Prüfung geändert von "pause >= start" auf "entry umfasst pause"
#
# ÄNDERUNGEN v3.3:
#   ✅ Kalender: Unnötige innere Scrollbar entfernt
#   ✅ Battle Pass: Nur Reward-Schiene scrollbar, nicht das ganze Fenster
#   ✅ Fortschrittsbalken: Endet mit Punkt-Marker statt smooth
#   ✅ Auto-Scroll: Punkt wird bei 75% der Scrollbar-Breite positioniert
#
# FEATURES v3.2:
#   - Battle Pass: Klick auf "Diese Woche" öffnet Wochen-Übersicht
#   - Kategorien-Fortschritt im Battle-Pass-Style (horizontale Balken)
#   - Reward Track: Items alle 5h (bis 40h), danach alle 1h (bis 80h)
#   - Sammlung-Tab: Zeigt alle gesammelten Items mit Statistiken
#   - Wochenrückblick-Tab: Detaillierte Wochen-Zusammenfassung
#   - Auto-Collect: Items werden automatisch beim Öffnen eingesammelt
#   - Persistenz: Gesammelte Items werden in localStorage gespeichert
#
# FEATURES v3.1:
#   - Pausen werden in abgeschlossenen Einträgen angezeigt
#   - Kalender: 24h-Ansicht mit Auto-Scroll zu 7 Uhr
#   - Kalender: Pausen sind sichtbar + im Dialog bearbeitbar
#   - Mitternacht: Timer wird um 23:59:45 gestoppt
#   - Browser-Tab blinkt bei Auto-Stopp
#   - Auto-Refresh: Wochenziele + Stats alle 5 Minuten
#
# FEATURES v3.0:
#   - Reine Wochenbetrachtung (Statistik)
#   - 8-Wochen-Benchmark mit historischem Durchschnitt
#   - Manueller KW-Vergleich
#   - Stacked Bar Charts + Area Charts
#   - Live-Timeline mit Pausen-Editing
#   - Progress Rings für Wochenziele
#   - Glassmorphism-Design
#
# ============================================================================
# Verwendung:
# docker compose down && docker compose up -d --build

services:
  timetracker:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - VITE_SUPABASE_URL=${VITE_SUPABASE_URL:-}
        - VITE_SUPABASE_PUBLISHABLE_KEY=${VITE_SUPABASE_PUBLISHABLE_KEY:-}
        - VITE_SUPABASE_PROJECT_ID=${VITE_SUPABASE_PROJECT_ID:-}
    image: timetracker:latest
    container_name: timetracker
    ports:
      - "${PORT:-3000}:80"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s
    labels:
      - "com.timetracker.description=Zeit-Tracking Anwendung"
      - "com.timetracker.version=3.6.0"

networks:
  default:
    name: timetracker-network
